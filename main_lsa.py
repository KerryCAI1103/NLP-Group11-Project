import re
import jieba
import numpy as np
import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.decomposition import TruncatedSVD
from sklearn.metrics.pairwise import cosine_similarity
import logging

# 关闭 jieba 的繁琐日志输出
jieba.setLogLevel(logging.INFO)

# ==========================================
# 1. 样式与配置
# ==========================================
class Color:
    PURPLE = '\033[95m'
    CYAN = '\033[96m'
    DARKCYAN = '\033[36m'
    BLUE = '\033[94m'
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    RED = '\033[91m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'
    END = '\033[0m'

# ==========================================
# 2. 核心类定义：SVD语义推荐器
# ==========================================

class SVDRecommender:
    def __init__(self, data_text):
        # 1. 扩充停用词表
        self.stop_words = set([
            "的", "了", "在", "是", "我", "有", "和", "就", "不", "人", "都", "一", "一个", "上", "也", "很", "到", "说", "要", "去", "你", "会", "着", "没有", "看", "电影", "影片", "片子", "本片", "这部", 
            "它", "我们", "自己", "可以", "这个", "那个", "虽然", "但是", "因为", "所以", "以及", "对于", "之后", "为了", "其实", "甚至",
            "：", "，", "。", "、", "“", "”", "（", "）", "！", "？", "《", "》", "-", "--"
        ])
        
        # 2. 解析文本数据
        self.movies_df = self._parse_data(data_text)
        
        # 检查点：打印加载数量
        if len(self.movies_df) < 99:
            print(f"{Color.RED}⚠️ 警告：只加载了 {len(self.movies_df)} 部电影，请检查数据格式是否包含不一致的标点符号。{Color.END}")
        else:
            print(f"{Color.GREEN}✅ 成功加载 {len(self.movies_df)} 部电影数据。{Color.END}")
        
        # 3. 预处理
        print(f"{Color.BLUE}⚙️ 正在进行分词与清洗...{Color.END}")
        corpus = [self._preprocess(content) for content in self.movies_df['content']]
        
        # 4. 计算 TF-IDF
        print(f"{Color.BLUE}📊 正在构建 TF-IDF 矩阵...{Color.END}")
        self.vectorizer = TfidfVectorizer(min_df=2, max_df=0.95) 
        self.tfidf_matrix = self.vectorizer.fit_transform(corpus)
        
        # 5. SVD 降维
        print(f"{Color.BLUE}🧠 正在进行 SVD 语义降维...{Color.END}")
        self.svd = TruncatedSVD(n_components=20, random_state=42)
        self.lsa_matrix = self.svd.fit_transform(self.tfidf_matrix)
        
        print(f"{Color.GREEN}✅ 模型构建完成！{Color.END}")

    def _parse_data(self, text):
        movies = []
        # 🟢 修复后的正则：兼容 "21、" (顿号) 和 "22." (点)
        # [、.] 表示匹配这两个符号中的任意一个
        pattern = re.compile(r'\d+[、.]\s*《(.*?)》\s*(.*?)(?=\n\d+[、.]|\Z)', re.DOTALL)
        
        matches = pattern.findall(text)
        for title, content in matches:
            movies.append({
                "title": title.strip(),
                "content": content.strip().replace('\n', '')
            })
        return pd.DataFrame(movies)

    def _preprocess(self, text):
        words = jieba.cut(text)
        return " ".join([w for w in words if w not in self.stop_words and len(w) > 1])

    def recommend(self, query, top_k=5):
        query_processed = self._preprocess(query)
        if not query_processed.strip():
            return []

        query_vec = self.vectorizer.transform([query_processed])
        query_lsa = self.svd.transform(query_vec)
        
        similarities = cosine_similarity(query_lsa, self.lsa_matrix)[0]
        top_indices = similarities.argsort()[::-1][:top_k]
        
        results = []
        for idx in top_indices:
            score = similarities[idx]
            if score > 0.1: 
                results.append((self.movies_df.iloc[idx], score))
        return results

# ==========================================
# 3. 数据加载区 (请保持你的数据不变)
# ==========================================

# ⚠️ 这里请继续保留你之前粘贴的那一大段 raw_data
# 我就不重复粘贴那一千行了，你原来的 raw_data 是完全没问题的
# 只是正则解析器太“死板”了，现在修好了。
raw_data = """
1、《肖申克的救赎 》
中外公认的长期排名豆瓣和IMDB第一的片子... (此处省略，请务必保留你代码里原本完整的内容) ...
""" 
# (如果你之前的代码里 raw_data 已经被清空了，请把上一轮你发给我的那个完整的 raw_data 复制回来)
# 为确保运行，我这里需要把完整的 raw_data 再次赋值给你吗？
# 如果你在本地修改，只需要改 _parse_data 函数即可。
# 如果你需要我再发一次带数据的完整包，请告诉我。
# 这里假设你已经有了 raw_data。

# 为了演示修复效果，我模拟一下数据开头和中间的格式差异：
raw_data = """
1、《肖申克的救赎 》
中外公认的长期排名豆瓣和IMDB第一的片子，放在除《阿甘正传》之外的任何一年都应该是奥斯卡最佳影片，但被阿甘正传的主旋律讨了巧。电影之所以即使没有爱情和女主，确认可度穿越时间和空间，就在于它探讨的主题是每个年代永恒的：体制化、围城、希望、坚持等。监狱的象征意义不用多说，布鲁克斯的故事线以及瑞德的评价令人印象深刻。每个人都在一个环境中，刚开始你憎恨它，后来你习惯它，再后来你依赖它，离开它你无所适从。这个象征意义真的太广了，可以理解为舒适区，也可以理解为被体制化（磨平了棱角）。监狱的层级镇压，汤米死亡的黑暗时刻，无一不暗喻这个世界几千年几乎不变的机制。你是否又在一些配角的身上看到了自己的影子呢。安迪是真正的梦想家，他从未因黑暗和恐惧而沦为真正的囚犯。阳光洒肩头，屋顶喝啤酒；坚持给州政府写信；反抗姐妹帮；改善图书馆；即使被禁闭也要用音乐的力量让人感受希望和自由（本片十分浪漫的时刻）；以及本片最大的悬念--挖了19年的隧道。这种艺术性的表达方式让人感受到励志的力量。我们个人、团体、组织、社会是否都曾陷入过“监狱”，是什么让我们一直在进步，影片从多种十分契合现实的角度去阐述了这个主题--希望、勇气。此外，影片不光只是单纯的励志，如何用科学的方法逃出“监狱”，也给了观众结合自身去思考的空间。影片的旁白结合影片的叙事节奏让人感觉没有一处废笔。埋了两小时的悬念揭晓时让观众惊讶不已。
2、《霸王别姬》
本片是豆瓣前十中唯一一部国产影片。电影借用霸王别姬戏剧这一载体，展现了段小楼、程蝶衣、菊仙、四爷、小四等人在时代裹挟下的不同命运，也可以说是不同的选择。这个时代从民国年间到文革结束，期间包括抗日战争，解放战争，电影展现出一种时代感、史诗感，看完之后让我对其中各个角色展现出的人性唏嘘不已。与此同时，电影中的戏曲元素和打磨的台词以及独特的光影效果也让我感受到导演渲染的独特艺术魅力。每个主要角色都对应着现实生活中的不同类别的人，程蝶衣和菊仙是纯粹的理想主义者，段小楼是现实主义者，小四是理想的背叛者。蝶衣人戏不分“不疯魔不成活”的极致浪漫、菊仙在被段小楼当众抛弃的悲剧、段小楼这一假霸王的横跳、袁四爷的知音身份和被历史淘汰、师傅临终前的潜心投入专注的最后一嗓子、蝶衣最后自刎的解脱等等。电影将对艺术的浪漫追求、角色之间的感情、时代的变迁、人性的展示结合在一起。看完之后心情复杂，有一种浪漫感和悲壮感同在的感觉。
3、《阿甘正传》
这部电影很特殊。小时候看我只感觉到阿甘的憨厚和他的有趣的运气，最后在羽毛漂浮的镜头中感受到人生的无常和阿甘努力向上生活的正能量。但长大之后了解片中带有的政治意味，便觉得有点反感。它跟《霸王别姬》排名接近，也同样带有时代感。但是，两者的区别在于，阿甘的经历都是强行安排的，看的时候感觉很有趣但是其逻辑性和真实性是经不起推敲的，你到底是拿一种喜剧的角度还是真实时代的角度去理解电影呢。阿甘憨厚，只知道奔跑和珍妮，这种保守主义的象征，在影片中涉及的时代事件中获得了无比的成功。我也想像小时候一样从看起来很娱乐、简单的电影中得出令人感动的东西，但严谨分析电影的艺术性，阿甘真的可能有太多争议，那些巧克力可能没有那么地甜。电影巧妙的回避了一些问题，好莱坞的聪明人把阿甘送上了神坛。但电影中，阿甘的坚持执著的正能量、叙事节奏的掌握、在阿甘身上看见自己的映射、美式幽默结合傻人有傻福的感动综合笑中带泪等也充分展现了导演的功力，这也是电影评分排名如此高的原因
4、《这个杀手不太冷》
大约十年前我看过这部电影，十年间记忆逐渐淡去，其给我留下的模糊印象是一个冷酷但温情的厉害杀手和一个古灵精怪的御姐心萝莉。再次用鉴赏的角度去重温电影，我觉得电影的厉害之处就在于能给人留下两个性格鲜明的人物以及他们在孤独中互相吸引的爱情。吕克贝松的叙事节奏和镜头语言是非常棒的，能够紧紧抓住观众的眼球。本片的配乐制作水准也极高。电影之所以受到多数人的垂青最大的原因在于：共情。电影的情感展示、表达都非常的细腻，小细节很多，就像一部刚泡的的咖啡，热气逐渐包括着你。杀手孤身一人，小女孩也孤身一人，两个人因为命运相遇，然后共同生活、嬉笑打闹、珍重彼此。你保护我，我温暖你。我们都是孤独的人，我们间有着最纯粹的互相吸引互相依赖。“这其实是一个十二岁的女孩和一个十二岁的男孩的故事”这句话浓缩了本片的精华之处。多年之后，枪战杀人的剧情早已忘却，但那个温情杀手大叔和御姐气质萝莉的组合以及他们间纯粹的情感却依然刻在脑海，这就是这个电影的魅力。
学术化的语言总结就是：1满足人们对纯粹感情的向往；2给孤独的人心灵港湾；3把爱的发展刻画的如此细腻。
5、《泰坦尼克号》
一部反映真实世界、讴歌永恒爱情、海难场面震撼的经典商业片。詹姆斯卡梅隆总是能烧钱拍出一代神片。在长达三个小时的正式版电影中，爱情方面，穷小子吸引富家女的桥段并不新颖，但电影的情感刻画依然细腻，富家女被禁锢，因为家庭债务没有婚恋自由，未婚夫也并不是真的懂她。他们在一来一回中，在大海上，在落日余晖中，在马车上，确认并加深了彼此的感情，在海难时刻，两人第一时间想到的都是彼此并从未放弃对方，这样的爱情更加弥足珍贵，杰克甚至付出了生命代价，而萝丝也带着杰克深沉的爱这种信念尽力的活了下去；另一方面则是电影用一二三等舱刻画出一个金钱等级社会，并用种种细节展示着阶层之间的区别，船成了一个俯瞰社会的小模型；在突如其来的海难来临之际，电影给人带来紧张的节奏让人捏一把汗，而各色各样的人的不同反应也让人唏嘘不已，内疚无比的船长、不堪压力的大副、永不沉没的布朗、伪君子未婚夫、优雅死去的大企业家、坚持到最后一刻的乐队、为了保全自己拒绝回去营救的沉默众人等等，只有突发的海难能在这么短时间看到这么多面的性格人生。自私的人性显露无疑但同时也有博爱、勇气的光辉在闪耀，怎么去解读就看你在其中看到了什么。总结：这是一部浪漫永恒爱情、悲情海难、复杂人性解读这三个主体元素综合的经典电影。
6、《美丽人生》
看一次哭一次的电影，罗贝托贝尼尼最后眨眼，笑着走大迈正步赴死的场景是永远的影史经典。前半段的幽默风趣和意大利式的浪漫让人忍俊不禁，奎多给她在雨中铺红毯的场景和那句“早安，我的公主！”真的是让我这个理工男都感觉浪漫的不行！前半段的真挚爱情有多美丽，后半段的结局就让人多心疼。伟大的父亲，为孩子勾勒出一幅美好的游戏，在残酷的、血淋淋的现实面前用喜剧的角度玩一场游戏，即使赴死我也会留给你美好的一面。这种美好生活的浪漫幽默、对抗悲惨生活的积极乐观、保护孩子的温柔父爱、喜剧悲剧的突然碰撞，永恒的感动永恒的艺术魅力，绝对满足任何品味的观众。
7、《千与千寻》
如果将千与千寻排进该榜单的动画电影第一名，从鉴赏的角度来说我没有任何的异议。这是一部当之无愧的面向全年龄段的神作（虽然我个人最喜欢的动画电影是《寻梦环游记》，这个后面会写，千与千寻是我第二喜欢的）。很多人可能都看过这个电影，但真的每一次看都有不同感受。为什么？好的作品会有足够的欣赏空间和内涵，并且主旨足够永恒。先谈其他的--制作和作曲。久石让的配曲真的是顶级中的顶级。看过原片并了解作品背后的故事就知道宫崎骏对于作画和美术的要求有多么高。千与千寻中工业化相关的因素应该是拉满了。再谈主旨和节奏等，动画的大的主旨极具日本本土特色的时代特征，宫崎骏在动画中对于日本泡沫经济中盲目自信的疯狂时代进行了提点，又用千寻这个十岁的小女孩的冒险旅程传达了一些更智慧的特性才能带来真正的持久--对于自身发展和人类社会发展。这些特性包括但不限于：不被黑暗吞噬、努力工作、逆境中的坚强、真诚对待朋友。只有这样特征的千寻才能拯救贪吃的父母。影片中隐藏的暗喻太多就不一一阐述，但暗喻也基本在于这个大的主旨框架下，如河神的情节暗示环境保护，大家谄媚无脸男为金主暗示社会法则，巨婴暗示平成废宅。节奏上，水上电车戏已经到影片的末尾，按理说到了影片高潮，但是这里的处理却十分的“安静”，这种安静是十分难得的。影片带来了一个奇幻的世界，埋下了了救父母和救白龙的矛盾，但用非对抗的方式结束也契合着本片主旨。影片最后，千寻回头看了隧道一眼但眼神已然更坚定，接着这场冒险在清亮的歌声中画上了句号。
8、《辛德勒的名单》
太真实了，太沉重了。我只能用这八个字太形容这部“十分纪实”的剧情片，看完美丽人生再看辛德勒名单真的太压抑了。这让我想起高中时的课文《奥斯维辛没有什么新闻》。无辜生命的流逝是那么简单、随意，犹太人的乐观、积极和智慧（往脸上抹血以表现自己身体健康的行为）是那么让人动容，两者的对比以红衣小女孩最终的死去为明线展现出来。那么小的孩子为了逃避屠杀到处躲藏，德军士兵为了翻个底朝天甚至夜晚蛰伏，钢琴声和枪声同时响起，美好被瞬间摧毁。生死的话题总是那么沉重。高斯的残暴体现在每一处，即使他接受了辛德勒关于power的阐述，但是他依然在放走男孩后开枪杀死了他。焚烧尸体时怒吼的士兵展示着扭曲的人性。辛德勒也不是一个脸谱化的善人，他的思想转变是有过渡的，刚开始的他是一个喜欢投机、喜欢漂亮女打字员、讨厌少一只胳膊的老人的商人，后来的他良知发现，倾家荡产救下了1100多名犹太人，片尾描述中这1100多名犹太人现已有6000人。“在罪恶横行霸道妄图一手遮天时，正是辛德勒先生的人性绽放的光芒，让我们在漆黑里苦等也不至于彻底绝望”
9、《盗梦空间》
影片的设定新颖且具有循环性。尤其是三重梦境破坏一致性的设定和植入想法的“犯罪”，都让人耳目一新，电影也靠着三重梦境紧张的把控着各条线的叙事节奏，让人心情紧张。男主身上的谜底逐渐揭开，让人去思考什么是梦，我们的想法和认知究竟是怎么构成的，它是否真实。有趣的是，按照电影的情节发展和逻辑自洽，最后男主应该是回到了现实，但是我们依然紧紧盯着旋转的小陀螺，是否我们在这两小时也接受了诺兰给我们植入的想法：要依靠陀螺是否停止旋转来判断是否在现实还是梦境。诺兰扮演了一次盗梦者。梦是什么？现实和虚拟，这些暂时未揭开的谜题，诺兰用其紧凑的故事风格、自洽的故事逻辑、新颖但能讲述明白的设定，让我们体会了两个小时的梦境，or，现实？
10、《忠犬八公的故事》
这是一个真实的故事。每天的5点零5分，都会有一只乖狗狗，坐的笔直，在小城的车站门外等待主人的归来。有一天，主人去了，再也没有回来，永远的离开了它。在这过去的9年里，每一天，风雨无阻，春夏秋冬一个又一个得交替，它依然在那里等待，等待有一天主人回来。

最感动的片段，是狗狗主人的妻子，很多年后来到小城车站，看到八公。它老了，脏兮兮的，她抱着它，默默的流泪。

影片的封面有一句话：“永远记得我们相遇的那一天。”

它们只是我们生命里的一个小片段，甚至有时候是一个小麻烦，但是我们确是它们的全部。

后记：我经常上来看到大家的回复，心里觉得暖暖的，我们，因为一部电影，因为一只狗狗，找到共鸣。有时候怀疑文字的力量，虽然我经常看别写的影评或者是别的东西的时候哭的稀里哗啦。看到许多人因为我写的话而感动，心里默默说，是八公，让我们在一起。
11、《星际穿越》
电影的艺术性在于科幻和穿越时空的爱，理性和感性的结合，冒险和亲情的赞歌。对于诺兰，我个人是认为该片的艺术性是高于《盗梦空间》的，因为它的主题更永恒。本片的科幻理论和视觉震撼在放到现在也不算过时。看完之后的感受只有震撼。人类的赞歌就是勇气的赞歌，两个航天员在水星球上的牺牲、罗米枯燥的等待了二十三年、马修愿意牺牲自己、墨菲等待父亲几乎绝望，人类在探求边界和找寻更多的可能上，总会有人勇敢的站出来，他们是真正的英雄。布兰德在查看二十三年间的录像带时，我也不禁跟着她一起泪流满脸，那种沧桑、那种无奈，因为他们要探寻前沿，所以不得不失去这些。曼恩展现了人在没有希望之时自私的一面，但马修的伟大又让人再次动容。影片更难能可贵的是埋下足够多的伏笔以及墨菲和马修那穿越时空的约定/爱，时间让人老去沧桑让人流泪，空间让父女之间长时间不能见面。但无论如何我都相信你一定会回来拿那块表。高深的科学背后包裹着柔软的情感，现实主义和浪漫主义的结合，爱可以穿越时空，你已白发苍苍但我依然会喊你一声女儿。勇气和爱，最终拯救了人类。
12、《楚门的世界》
电影的艺术性在于创新性的新颖设定以及可解读引申的丰富内涵。被安排到几乎没有挑战的生活，但却日复一日的枯燥，你是否能发现，你是否会被扼杀，你是否想逃离？我们是楚门、导演、观众还或者是那个女主？我们都活在被设定的世界里面，我们能否像楚门一样，当你想逃离这个虚假的世界面临巨大的阻力时，依然能保留梦想的火种？你是楚门的话，你可以像他一样歪头笑着说出“如果再也不能见到你，祝你早安、午安、晚安”？你是导演的话，这个被安排的生活真的是楚门想要的吗，是不是他靠自己逃离了之后你还要假惺惺的和他来一场对话？你是观众的话，你是不是只是在乎有没有故事看呢？往大了说，人类社会是不是也是在不断突破出楚门的世界的追求下才不停进步的？好的作品可以让不同的人看到自己的影子。
13、《海上钢琴师》
一个活着的人，却在世间没有身份；一个钢琴天赋异禀的人，却不想上陆地追求喜欢的女孩以及名利。本片的艺术性在于借用很大海上的大船这一大家不太接触的新颖环境，结合音乐元素，用浪漫主义的手法很好的表现了主题：孤独。若有人问为什么1900最后船都要爆炸了都不下船，并且他朋友为什么不强行把他拉下船，那我只能说你还没真正理解1900。不能完全片面的认为1900不想走出舒适区。孤独是每个人都曾经历过的事情。1900选择了放下并不能简单的理解成固步自封。他宁愿孤独一生，也不愿随波逐流。人的内心可能比海还要深。天才的差异让他们忧郁的注视着人群，躲在船上的内心世界里。“活着，还是活得安心，这是个问题，凡人的选择是无论如何先活下去再说，而天才则把心灵的舒适看得更重，生死则次之”。虽然我不能完全赞同，但我十分尊重理解。
14、三傻大闹宝莱坞
“追求卓越，成功自会追上你”。影片的优点在于用理想主义去面对现实问题，并弘扬人性中的真善美，讽刺了自私、刻板、内卷竞争等问题，是一部吵闹但是看下来感觉励志的片子。校长、大傻、二傻三人的转变是故事的价值观的核心体现。不要推着孩子走看似正确的路，让他们努力去竞争却忘了他们真正想做什么；担心明天，今天又能怎么做好呢，迷信只是丧失了逃避生活的勇气；就算真的做不了摄影师，难道人在从事、学习自己喜欢热爱的事情的时候不是更高意义上的成功吗？或许影片的很多情况在现实中难以实现，因为不是所有人都像兰彻那样天才，也可能遇到的不是那样古板的校长，但影片对呆板、自私、填鸭应试教育、拉踩他人等进行讽刺，并告诉观众找到自己的热爱、不要困于自己不要困于恐惧、努力追求卓越等等，这些赞扬的东西在我们人生低潮时期可以鼓舞我们振作调整自己，冲向更美好的明天。此外影片还反应了不少印度的社会问题如种姓制度、医疗制度。影片的叙事手法采用回忆+现实双线。影片的喜剧元素结合故事节奏也十分恰当。”当你的朋友考倒数第一时，你感到痛苦；当你的朋友考第一名时，你更痛苦。”忍俊不禁。影片在中外榜单排名的差异也可以反应出中国存在着更多对热爱、追求卓越等的教育力度不足，并且依然存在着不少应试教育、缺少实践的问题。
15、《机器人总动员》
截止目前，绝对是动画电影历史上值得铭记的里程碑之作。我不会说最强或者Top1这种。但值得称赞的是电影的主题是环保但从头到尾没有直接宣传，以及电影开头的默片却渲染了孤独的氛围。可爱又萌的瓦力对伊芙的纯粹爱慕让其一路追到了飞船并在关键时刻力挺了伊芙，这是何等的浪漫，两个机器在太空飞行绕弯的情景也让人十分动容。动画不乏美式幽默，又结合了日本动画的细腻情感。（这对后续皮克斯、迪士尼的创作有一定的影响，看看其他总动员及狮子王再看看后面的动物城、飞屋、寻梦，会感受到作品之间的转向）。机器下包裹的是瓦力的一颗真诚的心。
16、《放牛班的春天》
18岁左右的人看应该很有感触。一部在底层人民身上发生的用音乐感化孩子、用音乐给予孩子力量的上乘教育片。音乐的力量和感染力被影片细腻的刻画，最后的一群纸飞机让人感受到教育带来的成就感和意义。影片中孩子的音乐也真的太好听了啊！影片在中外的评价是不一样的，这对于中国教育也是一个反思。马修这样绅士高雅、坚守初心、用心良苦的老师，在我们的求学生涯中遇到是一件幸运的事情。
17、《无间道》
警匪片里程碑之作。往前的警匪片多数是猫和老鼠的博弈。制作也偏元素糅合和随意。无间道第一次用双主角的方式展现警匪卧底纠结博弈的复杂。视觉、故事、情感变得精致。电影将人性抽丝剥茧给观众感受。人物的复杂性和层次性被梁朝伟演绎出妙到毫巅，那种克制、隐忍、放松、悲伤、紧张全都被他那双会说话的眼睛细腻传达。可以说梁朝伟压住了整部电影。电影的镜头语言和节奏控制也非常的好 。陈永仁在电梯前被一击毙命以及后续随着电梯急速坠落刘建明连开几枪的画面实在令人印象深刻。电影开头的佛曰很难说没有对陈思诚的唐人街系列产生影响，电影也到了探究人性道义的高度。
18、《疯狂动物城》
动画电影在豆瓣top250评分算是偏高的，因为其大众化的受众。但得承认这部电影各方面也的确拉满了。立意内涵的高度（讽刺政治体制的一些现象）、元素（梦想追求的正能量、狐兔的角色碰撞、美式幽默、剧情反转）、故事节奏、音乐制作、画面制作都是顶级水准。
19、《大话西游之大圣娶亲》 
这部奇幻爱情喜剧是周星驰解构经典的巅峰之作。它在前作无厘头的基础上，注入了深刻的悲剧内核。至尊宝在穿越中领悟“舍生取义”，戴上金箍成为孙悟空，却必须舍弃人间情爱。影片将宿命、责任与爱情的对立展现得淋漓尽致，“一万年”的誓言成为最凄美的情话。情感在狂笑与痛哭间极端跳跃，最终留下一个充满遗憾的悠长背影，是华语影坛独树一帜的后现代悲情史诗。
20、《熔炉》
这部韩国现实题材剧情片，改编自光州聋哑学校性侵真实事件，以其直面黑暗的勇气震撼社会。影片毫不煽情地呈现了弱势群体遭受的欺凌与系统性的腐败包庇，压抑中积蓄着巨大的愤怒力量。孔刘饰演的教师为正义奔走的历程，彰显了平凡人的良知与担当。电影情感沉重而绝望，但结尾那句“我们一路奋战，不是为了改变世界，而是为了不让世界改变我们”，又赋予了悲剧一丝不灭的希望之光，直接推动了韩国相关立法，彰显了电影的社会价值。
21、《控方证人》
这部法律悬疑剧情片改编自阿加莎·克里斯蒂的经典作品，堪称法庭戏剧的教科书。影片围绕一桩富婆谋杀案展开，病弱却精明的律师韦菲爵士为嫌疑人沃尔辩护，而关键证据指向了其冷静的妻子克里斯汀。电影以环环相扣的庭审辩论和令人拍案叫绝的多重反转著称，台词机锋处处，悬念保持到最后一秒。情感上，它交织着智力角逐的紧张快感、对人性复杂面的深刻洞察，以及一丝黑色幽默。其结局的反转不仅震撼，更升华了对爱情、欺骗与牺牲的探讨，是影史悬疑片中永不褪色的瑰宝。
22. 《触不可及》
这部法国喜剧剧情片基于真实故事，讲述了瘫痪富豪菲利普与出身底层的陪护德希斯之间一段超越阶级、种族的非凡友谊。影片幽默温暖，以轻松诙谐的方式消解了沉重的议题。两人从互不理解到成为灵魂挚友，互相填补了生命的残缺。电影表达的核心情感是平等、尊重与生命的欢愉，证明了真诚的友谊能打破一切固有壁垒，给人带来笑中带泪的深切感动。
23. 《寻梦环游记》
这部动画音乐奇幻片以墨西哥亡灵节为背景，构建了一个绚烂温馨的“死后世界”。故事讲述男孩米格尔穿越亡灵国度，追寻音乐梦想与家族秘密的旅程。影片巧妙地将“死亡”定义为终极遗忘，强调记忆与传承才是连接亲情的纽带。情感真挚饱满，《Remember Me》的旋律贯穿始终，催人泪下。它歌颂了家庭之爱，探讨了梦想与亲情的和解，是一部关于生命、记忆与告别的深情之作。
24. 《教父》
这部黑帮史诗剧情片不仅是一部犯罪电影，更是一部关于权力、家族与美国的寓言。影片以沉郁优雅的笔调，描绘了维托·柯里昂家族从兴起到权力交接的历程。马龙·白兰度与阿尔·帕西诺的表演堪称不朽。电影情感复杂深邃，既有黑手党的冷酷法则，也有对家庭的责任与柔情，最终在迈克尔步入黑暗的转身中，奏响了一曲宏大而悲凉的命运交响曲，重新定义了类型片的高度。
25. 《当幸福来敲门》
这部励志传记剧情片根据克里斯·加德纳的真实经历改编。威尔·史密斯演绎了一位濒临破产、妻子离家的推销员，如何带着幼子忍受 homelessness 的屈辱，凭借不懈努力赢得股票经纪人实习机会的故事。影片没有廉价鸡汤，而是扎实地刻画了生存的艰辛与父爱的坚韧。情感质朴而充满力量，那句“别让别人告诉你你成不了才”鼓舞了无数人，是对奋斗、坚持与父爱最动人的致敬。
26. 《末代皇帝》
这部传记历史片以史诗般的格局，讲述了清朝末代皇帝溥仪跌宕起伏的一生。贝托鲁奇以外国导演的视角，充满同情地审视了溥仪从紫禁城的囚徒到时代洪流中的傀儡，最终成为普通园丁的悲剧命运。影片在故宫实景拍摄，气势恢宏，情感却极为个人化，充满了对个人自由被历史巨轮碾压的悲悯与对文化消逝的感伤，是一曲个人命运与时代变迁交织的华丽挽歌。
27. 《哈利·波特与魔法石》
这部奇幻冒险片开启了一个席卷全球的魔法时代。影片成功将J.K.罗琳笔下充满奇想的魔法世界视觉化，从九又四分之三站台到霍格沃茨礼堂，满足了所有读者的幻想。它不仅是哈利发现自身使命的起点，更是一场关于友谊（铁三角）、勇气与善恶初辨的启蒙之旅。情感上充满了初次踏入新世界的惊奇、温暖与些许危险，为后续宏大的叙事奠定了坚实而迷人的基础。
28. 《龙猫》
这部动画奇幻片是宫崎骏纯净童心的完美体现。影片以孩童的视角，讲述了姐妹二人在乡间与巨大而温暖的森林精灵龙猫相遇的故事。没有反派与激烈冲突，只有夏日微风、雨中等车、种子发芽等充满生命力的恬静细节。情感纯粹而美好，充满了对自然精灵的想象、对姐妹亲情的刻画，以及对逝去田园牧歌时代的深切怀念，宛如一首抚慰心灵的治愈诗篇。
29. 《活着》
这部历史剧情片改编自余华同名小说，通过福贵（葛优饰）一家在数十年中国历史变迁中的悲惨遭遇，展现了个人在时代巨轮下的脆弱与韧性。张艺谋的导演沉稳克制，将大喜大悲寓于平常之中。影片情感厚重苍凉，充满了命运的无奈与生命的坚韧。它既是对特定历史的反思，也是对“活着”本身——这一最基本又最伟大的人生命题的深刻诠释，悲情中透出顽强的生命力。
30. 《怦然心动》
这部青少年爱情剧情片，以双视角交替叙述，细腻刻画了女孩朱莉与男孩布莱斯从小学到初中情感关系的变化。影片清新脱俗，超越了简单的“初恋”主题，深入探讨了自尊、偏见、家庭价值与如何审视一个人的内在。情感纯真而富有层次，“斯人若彩虹，遇上方知有”成为经典注解。它歌颂了独立清醒的爱的能力，是一部关于成长与认知的美好教科书。
31. 《蝙蝠侠：黑暗骑士》
这部超级英雄犯罪片达到了商业与艺术哲思的巅峰。克里斯托弗·诺兰将蝙蝠侠与代表无序混沌的小丑（希斯·莱杰贡献影史级表演）的对决，上升至秩序与混乱、人性与规则的哲学层面。影片场面宏大，叙事紧凑，情感黑暗而复杂。它不仅是一部精彩的英雄电影，更是一次对正义代价、必要之恶与人性底线的严峻拷问，重新定义了超级英雄电影的深度与格局。
32. 《指环王3：王者无敌》
这部史诗奇幻片的终章，以气势磅礴的佩兰诺平原之战和惊心动魄的末日山之旅，为整个三部曲画上圆满句号。影片完美平衡了宏大的战争场面与细腻的人物情感，将友谊、忠诚、牺牲与希望的主题推向高潮。佛罗多与山姆的旅程尤其感人至深。情感上充满了悲壮的牺牲精神、胜利的狂喜与告别的感伤，是一部关于光明战胜黑暗的、具有崇高感的终极史诗。
33. 《我不是药神》
这部社会现实题材剧情片基于真实事件，以幽默与悲情交织的笔触，讲述了一个印度神油店老板程勇，从逐利到为白血病患者走私廉价仿制药的“药神”之路。徐峥的表演层次丰富。影片直面天价药与生存权的矛盾，情感在法理与人情的激烈冲突中迸发，充满了对底层疾苦的深切同情与对生命尊严的强烈呼喊。它是一部引发全民讨论、推动社会进步的现象级作品。
34. 《乱世佳人》
这部爱情历史史诗以美国南北战争为背景，讲述了南方庄园小姐斯嘉丽在动荡年代中挣扎求存、曲折追寻爱情的故事。费雯·丽与克拉克·盖博的表演光芒四射。影片规模宏大，情感波澜壮阔，斯嘉丽自私、坚韧、复杂的形象打破了传统女性刻板印象。“明天又是新的一天”的结尾，彰显了顽强的生命意志。它是关于爱情、生存与时代洪流的永恒经典。
35. 《飞屋环游记》
这部动画冒险喜剧以一段最浪漫的序章（夫妻一生蒙太奇）开场，讲述了寡居老人卡尔用气球拽着屋子实现亡妻遗愿的奇幻之旅。影片将童真冒险与老年释怀巧妙结合，在遇见小男孩小罗和神奇动物后，故事变得妙趣横生。情感内核是对爱与承诺的坚守、对梦想的执着，以及学会告别、拥抱新生的生命智慧。既天马行空，又感人至深。
36. 《让子弹飞》
这部黑色幽默喜剧剧情片以民国北洋年间为架空背景，讲述了土匪张麻子与恶霸黄四郎在鹅城斗智斗勇的传奇。姜文的导演风格凌厉酣畅，台词充满隐喻与机锋，情节跌宕起伏。影片表面是酣畅淋漓的复仇故事，内里却充满了对权力、革命、公平的复杂隐喻与尖锐讽刺。情感激昂、戏谑又带着悲凉，是一部值得反复品味、解读空间巨大的作者型商业巨制。
37. 《哈尔的移动城堡》
这部动画奇幻爱情片以战争为背景，讲述了被巫婆变成老太婆的少女苏菲，进入魔法师哈尔的移动城堡，并与之相爱的故事。宫崎骏延续了对反战、自我认同与纯真爱情的探讨。哈尔的脆弱与苏菲的内心成长是影片动人之处。情感浪漫而勇敢，表达了“爱能让垂老的心恢复年轻”的主题，在华丽视觉与奇幻设定下，是一颗反战与拥抱真我的温暖核心。
38. 《十二怒汉》
这部法律剧情片几乎全部发生在一个陪审团休息室内，是“密室辩论”电影的鼻祖。影片通过12位陪审员对一桩谋杀案的讨论，精彩演绎了偏见如何影响判断，以及理性、怀疑与良知在司法中的关键作用。亨利·方达饰演的8号陪审员以冷静与智慧扭转局面。影片情感紧张而充满思辨色彩，是对民主讨论程序正义的一次生动而有力的讴歌。
39. 《素媛》
这部韩国剧情片同样基于真实犯罪事件，聚焦于遭受性侵的小女孩素媛及其家庭漫长的心理修复过程。影片以极度克制和温暖的视角，避免了对暴行的直接渲染，转而深入刻画创伤后的亲情守护与社会压力。情感克制却具有穿透心灵的伤痛感与治愈力，那句“最孤独的人最亲切，受过伤的人总是笑的最灿烂”令人心碎。它是对受害者的深切关怀，也是对善良与坚韧的礼赞。
40. 《海蒂和爷爷》
这部家庭剧情片改编自经典儿童文学，讲述了孤儿海蒂与独居阿尔卑斯山的祖父之间，从隔阂到相依为命的动人故事，以及她后来在法兰克福的经历。影片画面如油画般优美，情感纯净如山中清泉。它歌颂了自然之美、隔代亲情的深厚，以及自由纯真的心灵对他人（如残疾小姐克拉拉）的治愈力量。情感温暖、明亮，充满了对生命本真状态的向往，是一部洗涤心灵的佳作。
41. 《猫鼠游戏》
这部犯罪剧情片讲述了天才少年弗兰克凭借过人智商伪装身份、骗取巨额钱财，最终与 FBI 探员卡尔展开一场智慧较量的故事。电影在紧凑的追逃情节中，暗藏对孤独、认同与家庭关系的深刻探讨。莱昂纳多·迪卡普里奥的表演生动诠释了一个渴望被爱的“骗子”，而故事结局则传递出救赎与成长的主题，让人在惊险之余亦感温情。
42. 《天空之城》
这部动画科幻冒险片是宫崎骏早期代表作，奠定了其将奇幻飞行器、自然主义与反战思想结合的风格。故事围绕拥有飞行石的神秘少女希达和少年巴鲁，寻找浮空帝国拉普达的冒险展开。影片画面壮丽，音乐空灵悠远。情感上充满了对失落文明的凭吊、对科技被用于毁灭的警示，以及对纯洁爱情与家园的守护之心。其核心主旨——即使再发达的文明，离开大地也无法生存，贯穿了宫崎骏的众多作品。
43. 《鬼子来了》
这部战争剧情片以黑白影像和荒诞的笔法，讲述了抗日战争期间，一个中国农民被迫看守日本俘虏而引发的一系列悲剧。姜文导演以独特的黑色幽默，深刻揭示了战争环境下普通民众的麻木、怯懦与生存哲学的破产，以及军国主义的虚伪残暴。影片情感复杂，在可笑可悲的情节推进后，结局色彩转换带来的斩首场面极具冲击力，是对历史与国民性一次冷峻而深刻的反思。
44. 《摔跤吧！爸爸》
这是一部感人至深的体育励志片，根据真实事件改编。父亲将摔跤梦想寄托于两个女儿，严格训练她们打破性别偏见，最终赢得荣耀。影片不仅展现激烈的比赛场面，更深刻刻画了父女之间的爱与冲突，传递出坚持、奋斗与女性自强的强烈情感。阿米尔·汗的演出令人动容，电影在热血中洋溢着亲情与尊严的力量。
45. 《少年派的奇幻漂流》
这部奇幻冒险剧情片讲述少年派在太平洋上与一只孟加拉虎同船求生的传奇故事。影片以极致唯美的视觉奇观展现海洋的壮丽与恐怖，内核却是一个关于信仰、生存与讲述的故事。李安导演通过双重叙事，引导观众思考真相与选择。电影表达了对生命韧性的赞美，以及在极端孤独中对精神寄托的渴求，情感深邃而充满哲思。
46. 《钢琴家》
作为一部战争历史片，影片冷静而克制地描绘了波兰犹太钢琴家在二战中挣扎求生的经历。它没有刻意煽情，而是通过主角的逃亡视角，展现战争对人性的摧残与零星留存的光辉。那场为德国军官弹奏钢琴的戏份，成为了绝望中艺术与人性短暂共鸣的绝响。电影表达的主要情感是深沉的悲怆、对生存的顽强坚持，以及在废墟中对尊严的最后守护。
47. 《指环王2：双塔奇兵》
这部史诗奇幻巨制的第二部，将故事推向更宏大的多线叙事。圣盔谷之战气势恢宏，彰显了人类在绝望中的勇气；佛罗多与咕噜的纠葛则深化了魔戒对人心的腐蚀主题。电影在黑暗压境的氛围中，交织着友情、忠诚与牺牲的情感。它既是一部充满动作场面的冒险传奇，也是一部关于信任、背叛与坚守光明的深层寓言。
48. 《死亡诗社》
这部校园剧情片以诗与理想对抗刻板与权威。罗宾·威廉姆斯饰演的基汀老师如同一股春风，用“抓住今天”的信条唤醒学生沉睡的灵魂与独立思考的能力。影片充满激情与浪漫，却也伴随着成长的阵痛与现实的残酷。它歌颂了自由思想的力量、对生命的热爱，以及对“我的人生该如何度过”这一终极命题的勇敢追问，情感真挚而极具感染力。
49. 《大话西游之月光宝盒》
这部无厘头喜剧奇幻片是解构经典的开端。周星驰用时空穿越和错位爱情，将西游记故事演绎成一场笑中带泪的闹剧。至尊宝与白晶晶的感情在误会与巧合中跌宕起伏，月光宝盒成为命运无常的象征。电影表面荒诞不经，内核却已初现爱情与宿命的悲剧色彩，情感在爆笑与突如其来的伤感间快速切换，开创了后现代爱情寓言的新篇章。
50. 《何以为家》
这部现实主义剧情片以犀利笔触直击黎巴嫩底层社会。男孩赞恩状告父母“生而不养”，揭开了难民儿童悲惨生存境遇的一角。影片采用近乎纪录片的风格，通过孩子早熟而绝望的眼睛，控诉了贫困、无知与系统性不公。它表达的主要情感是强烈的愤怒、无助与心碎，但在绝望深处，仍闪烁着孩子微弱却坚韧的求生意志与对公平的本能渴望。
51. 《闻香识女人》
剧情片《闻香识女人》通过中学生查理与盲人退役军官史法兰的短暂相处，展开一段关于尊严、选择与生命意义的对话。阿尔·帕西诺饰演的史法兰在绝望中仍保持优雅与幽默，一段探戈舞、一次法庭演讲成为影史经典。电影在低沉与激昂之间切换自如，最终指向勇气、真诚与人与人之间的相互救赎。
52. 《绿皮书》
这部公路喜剧剧情片根据真实故事改编，讲述意裔保镖托尼与黑人钢琴家唐·雪莉在南下巡演途中建立的非凡友谊。影片以轻松幽默的方式，直面美国上世纪60年代的种族隔阂。两个截然不同的灵魂在碰撞中互相影响、彼此治愈。电影情感温暖而有力，核心是跨越偏见与阶层的尊重与理解，歌颂了人性中真诚与善良的联结力量。
53. 《大闹天宫》
这部中国动画史诗是民族艺术的瑰宝。影片以恢弘的想象力将孙悟空反抗天庭的故事演绎得精彩绝伦。京剧脸谱化的造型、行云流水的动作设计、华丽绚烂的色彩，共同构筑了一个充满东方神韵的神话世界。它表达的情感是纯粹的反抗精神、对自由的向往与英雄主义的赞歌。其艺术成就与精神内核，使其成为中国动画史上永不褪色的经典。
54. 《黑客帝国》
这部科幻动作片革命性地定义了赛博朋克视觉美学与哲学深度。它构建了“现实世界”实为虚拟母体的惊人设定，探讨了真实与虚幻、选择与宿命、觉醒与奴役的深刻命题。基努·里维斯饰演的尼奥的救世主之路，充满东方哲学与西方动作片的融合魅力。电影表达了对系统化控制的警惕、对自由意识的追求，情感在冷峻的科幻外壳下涌动着解放的热血。
55. 《指环王1：护戒使者》
这部史诗奇幻的开篇之作，以惊人的匠心将中土世界带入银幕。从夏尔的田园诗到黑暗势力的崛起，电影成功建立起一个完整可信的奇幻宇宙。护戒同盟的形成，象征着不同种族为共同光明未来的携手。影片情感厚重，充满了启程的勇气、对家园的眷恋以及对即将到来黑暗的忧惧，为整个三部曲奠定了宏伟而深情的基调。
56. 《罗马假日》
这部经典爱情喜剧讲述了一位欧洲公主与一位美国记者在罗马一日之内发生的浪漫故事。奥黛丽·赫本与格里高利·派克的演绎堪称完美，将一段注定无果的爱情诠释得清新脱俗、永恒动人。影片在轻松诙谐的旅程中，暗藏对责任与自由、爱情与牺牲的讨论。其情感核心是甜蜜、短暂而永恒的遗憾，宛如一首精致的散文诗，歌颂了刹那即永恒的美好。
57. 《教父2》
这部黑帮史诗续篇采用双线叙事，平行展现维托·柯里昂的创业史与儿子迈克尔的守成与堕落。影片在广度和深度上超越了前作，更深层地揭示了权力、家族与美国梦的阴暗面。阿尔·帕西诺的表演将迈克尔在孤独、猜疑与冷酷中逐步沉沦的过程刻画得入木三分。电影充满悲剧性的宿命感，情感复杂而沉重，是对成功代价的一次冰冷解剖。
58. 《狮子王》
这部动画音乐剧以其磅礴的史诗气质和深刻的生命主题，成为迪士尼的巅峰之作。改编自《哈姆雷特》的故事框架，讲述了小狮子辛巴经历失去、逃避到最终承担责任、夺回王位的成长旅程。影片将亲情、友情、爱情与自然轮回之道完美融合，配乐恢弘动人。它表达的情感是对生命循环的敬畏、对过往错误的救赎，以及“记住你是谁”的永恒训诫。
59. 《天堂电影院》
这部意大利剧情片是一封献给电影与初恋的深情情书。通过主人公托托的成长，影片展现了电影如何照亮贫乏的生活，以及那些逝去的美好如何塑造一个人。阿尔弗雷多如父如友的引导，与无疾而终的初恋，共同构成了托托生命中甜蜜又酸楚的底色。电影情感浓郁怀旧，充满了对时光流逝的感慨、对电影艺术的挚爱，以及对故乡与初心的无尽乡愁。
60. 《饮食男女》
李安导演的这部家庭剧情片，以中华美食为表，伦理亲情为里，精湛地烹饪出一幕现代家庭生活悲喜剧。通过退休名厨老朱与三个女儿每周一次充满暗流的家宴，展现了传统家庭关系在新时代下的解体与重构。影片在精致的饮食文化展示中，透析了父女间的隔阂、沟通与深沉的爱。情感含蓄内敛又暗潮汹涌，最终落脚于对家庭纽带新形式的理解和释然。
61. 《辩护人》
这部韩国剧情片基于真实事件，讲述税务律师宋佑硕为被迫害的学生进行人权辩护的故事。影片以个人成长折射时代动荡，深刻揭露体制之恶，却又饱含希望与正义的情感。宋康昊的表演沉稳有力，电影在法庭交锋与情感挣扎中，唤起观众对良知、勇气与历史责任的思考。
62. 《本杰明·巴顿奇事》
这部奇幻爱情剧情片构想了一个“逆生长”的奇异人生。布拉德·皮特饰演的本杰明，身体从老年向婴儿倒退，与凯特·布兰切特饰演的黛西正常的人生轨迹交织、错过又重逢。影片以温柔而伤感的笔触，探讨了时间、衰老、爱情与死亡的本质。其核心情感是一种注定的、与时间逆行的浪漫悲情，让人深刻感受到“在时间面前，我们终将相遇，也终将分离”的宿命之美。
63. 《搏击俱乐部》
这部黑色喜剧剧情片是对现代消费社会与男性身份焦虑的一次极端反叛。通过杰克与泰勒分裂的人格，影片以暴力的“搏击俱乐部”为出口，宣泄被压抑的原始本能与对空虚生活的愤怒。大卫·芬奇凌厉的影像和颠覆性的叙事，充满对物质主义的嘲讽与对存在意义的 nihilistic 追寻。情感核心是极致的躁动、虚无与破坏欲，最终指向残酷的自我毁灭与涅槃。
64. 《美丽心灵》
这部传记剧情片讲述了诺贝尔经济学奖得主、数学家约翰·纳什与精神分裂症抗争的感人故事。影片没有过多聚焦学术成就，而是深入刻画他与幻觉共存的艰难历程，以及妻子艾丽西亚不离不弃的爱。它展现了一个天才最脆弱的内心世界和人性最坚韧的光芒。电影表达的情感是对爱的力量的至高礼赞，是对在精神深渊中依然追求理性与生命价值的非凡勇气的致敬。
65. 《穿条纹睡衣的男孩》
以二战为背景的战争剧情片，通过八岁男孩布鲁诺的纯真视角，呈现纳粹集中营的残酷真相。影片情感克制却极具冲击力，孩童的友谊与成人的罪恶形成尖锐对比。结局沉重而震撼，深刻揭示了战争对人性的摧残，以及无知与善良在历史悲剧中的无力感。
66. 《情书》
这部日本纯爱电影以其清新唯美的影像和细腻的情感，定义了亚洲爱情片的经典范式。通过往来书信，串联起一段被时光掩埋的青春暗恋。柏原崇倚窗读书的画面已成为不朽的影像符号。影片在冬日雪景与回忆暖色间穿梭，情感含蓄克制却后劲十足，充满了对逝去时光与未说出口爱意的无限追忆与怅惘，是“暗恋的极致”的完美诠释。
67. 《哈利·波特与死亡圣器(下)》
这部奇幻冒险系列终章，为长达十年的魔法史诗画上震撼句号。霍格沃茨终极决战气势磅礴，所有线索汇聚，秘密揭晓。影片在宏大的正邪对抗中，深刻探讨了牺牲、爱与选择的力量。斯内普的回忆成为最大情感爆点，彻底扭转了人物形象。情感上，它既是对青春告别的感伤，也是对勇气、友情与永恒之爱的盛大颂扬，满足了一代人的集体情怀。
68. 《两杆大烟枪》
这部英国黑色犯罪喜剧以其复杂的多线叙事、快速剪辑和英式冷幽默闻名。盖·里奇导演将一群小人物围绕两杆古董枪和一笔黑钱引发的连锁混乱，编排得如同精密齿轮。影片充斥着荒诞的巧合、暴力的戏谑与底层智慧。情感基调是玩世不恭的酷劲和峰回路转的爽快感，让观众在眼花缭乱的剧情中体验一场失控又最终归位的疯狂游戏。
69. 《窃听风暴》
这部德国历史剧情片背景设于东德高压统治时期。特工魏斯曼在监听剧作家德莱曼一家的过程中，人性逐渐苏醒，从监视者变为保护者。影片以冷峻克制的风格，展现了极权体制对人心的异化，以及艺术与良知如何在黑暗中悄然抵抗。情感深沉内敛，充满压抑下的紧张与人性光芒乍现的温暖，是对那个特殊时代一曲悲悯而有力的挽歌。
70. 《音乐之声》
这部经典音乐剧电影以其阳光般灿烂的旋律、阿尔卑斯山的壮丽景色和温暖的故事风靡全球。修女玛利亚用音乐和爱拯救了特拉普上校一家冰冷的心，并在纳粹阴影下捍卫自由与家庭。影片情感纯粹、乐观向上，《Do-Re-Mi》《雪绒花》等歌曲传递着无与伦比的欢乐与勇气。它是关于音乐治愈力量、爱能改变一切的家庭颂歌，历久弥新。
71. 《功夫》
周星驰的这部动作喜剧片是他作者风格的集大成之作。影片将小人物的励志故事、天马行空的武侠想象、无厘头笑料与特效动作完美融合。“猪笼城寨”宛如江湖缩影，各路高手隐于市井。情感上，它既是草根逆袭的热血童话，也是对武侠文化的深情致敬与解构。在爆笑与震撼的打斗背后，是“能力越大，责任越大”的朴素道理与不忘初心的赤子之心。
72. 《西西里的美丽传说》
这部意大利剧情片通过少年雷纳多的性启蒙视角，窥见战争时期美丽少妇玛莲娜的悲剧命运。影片以浓烈的情欲色彩开场，却逐步滑向人性之恶的冰冷深渊。玛莲娜成为全镇欲望与嫉妒的投射对象，在男权与战火中被无情吞噬又艰难重生。情感复杂，混合着青春的躁动、对美的毁灭的痛心，以及对麻木群众无声的控诉，宛如一首哀伤而愤怒的叙事诗。
73. 《哈利·波特与阿兹卡班的囚徒》
该系列第三部在风格上转向黑暗与复杂。导演阿方索·卡隆注入了更浓厚的哥特气息和情感深度。时间转换器的引入让叙事更加精巧，小天狼星与卢平教授的登场揭开了父辈的恩怨。影片着重刻画了哈利对亲情的渴望、对背叛的愤怒与原谅。情感上充满孤独、困惑与成长的阵痛，是哈利从男孩迈向青年的关键转折点，魔法世界也变得更加真实与危险。
74. 《阿凡达》
这部科幻史诗以其划时代的3D视觉技术重新定义了影院体验。詹姆斯·卡梅隆构建了令人叹为观止的潘多拉星球生态与纳美文明。故事上，它讲述了残疾士兵杰克通过“阿凡达”化身融入纳美部落，最终为守护家园而战。影片情感宏大，包含对殖民主义的批判、对自然万物的敬畏，以及跨越种族与身份的爱情与牺牲，是一场视觉与心灵的双重震撼。
75. 《看不见的客人》
这部西班牙悬疑犯罪片以其缜密层层反转的剧本著称。一场车祸掩盖的罪行，在律师与嫌疑人密闭空间的对话中，被不断推翻、重建。影片节奏紧凑，逻辑严密，每一次反转都既出乎意料又情理之中。情感核心是父母为子复仇的执念与智慧，与肇事者自私冷酷的对比强烈。它将悬疑叙事与人性拷问紧密结合，带来酣畅淋漓的脑力风暴与道德冲击。
76. 《拯救大兵瑞恩》
这部战争片以诺曼底登陆开场长达25分钟的残酷战役场面，重新定义了战争电影的写实标准。故事围绕一个小队深入敌后拯救一名士兵瑞恩展开，探讨“八个换一个是否值得”的生命价值命题。影片极度真实地呈现了战争的恐怖、混乱与士兵的恐惧，同时歌颂了同袍之情、责任与牺牲。情感沉重而崇高，是对战争最直白的控诉，也是对平凡英雄最深刻的致敬。
77. 《沉默的羔羊》
这部心理惊悚片将侦探故事与精神分析深度融合。朱迪·福斯特饰演的实习生克拉丽丝与安东尼·霍普金斯饰演的食人魔汉尼拔博士之间危险而智慧的对话，构成了影史最迷人的对立关系之一。影片氛围诡谲压抑，探索了创伤、欲望与权力的复杂心理。情感在恐惧与吸引间摇摆，核心是克拉丽丝试图拯救“羔羊”（无辜者）以摆脱内心梦魇的成长之旅，令人不寒而栗又深深着迷。
78. 《小鞋子》
这部伊朗儿童剧情片以极其朴素的镜头，讲述了一对兄妹因为丢失一双小鞋子而面临的困境。影片没有刻意渲染贫困，而是通过孩子纯真的视角和奔跑的身影，展现他们在苦难中的尊严、友爱与希望。阿里为赢得季军奖品（一双球鞋）而拼命奔跑的结局，真挚动人。情感纯净而坚韧，充满了童真的忧伤、兄妹深情以及在微小愿望中闪烁的人性光辉。
79. 《飞越疯人院》
这部社会寓言剧情片以精神病院隐喻僵化压抑的体制。杰克·尼科尔森饰演的麦克墨菲，用自由不羁的灵魂冲击着护士长拉契特代表的绝对秩序。他的反抗带来欢笑与生机，也招致最残酷的“治疗”。影片充满愤怒与悲怆的力量，表达了对个体自由被扼杀的强烈控诉，以及对“不自由，毋宁死”精神的礼赞。其结局震撼人心，留下永恒的思考。
80. 《布达佩斯大饭店》
韦斯·安德森的这部喜剧剧情片是其美学风格的巅峰。影片通过嵌套叙事，讲述一座欧洲大饭店的传奇往事与其主人的命运。极致的对称构图、糖果般鲜艳的色彩、快速精准的台词，营造出一个精致如玩具盒般的怀旧世界。在诙谐幽默的逃亡故事背后，是对欧洲文明逝去优雅的哀悼，对友谊、忠诚与人文精神的坚守。情感是甜中带涩的浪漫挽歌。
81. 《蝴蝶效应》
这部科幻心理惊悚片探讨了“如果能改变过去”的经典命题。男主角伊万通过阅读日记回到童年关键节点，意图修正错误，却引发连锁反应，导致现实滑向更糟的境地。影片结构精巧，多个版本的结局发人深省。情感核心是深深的无力感与宿命论，表达了对完美主义的警示：每一个选择都塑造了我们，接受不完美的过去，或许才是拥抱当下的唯一途径。
82. 《禁闭岛》
这部心理悬疑片营造了完美的迷雾氛围。联邦警官泰迪到孤岛精神病院调查失踪案，却发现自己陷入记忆与现实的迷宫中。马丁·斯科塞斯精湛的导演手法，让观众全程与主角共同怀疑、推理、震撼。影片真相残酷而悲伤，深刻探讨了创伤、罪恶感与自我欺骗。情感上是层层递进的 paranoid（偏执）与最终揭晓时的巨大悲悯，令人久久无法释怀。
83. 《心灵捕手》
这部剧情片讲述了一个数学天才威尔在清洁工外表下，隐藏着创伤与自我防御的心灵。在教授蓝波与心理咨询师尚恩的帮助下，他逐渐直面过去，打开心扉。罗宾·威廉姆斯与马特·达蒙的对手戏充满火花与深情。影片情感真挚而富有哲理，核心是关于接纳不完美的自我、勇敢去爱与被爱的成长故事。那句“不是你的错”的反复诉说，是影史最动人的治愈时刻之一。
84. 《致命魔术》
克里斯托弗·诺兰的这部悬疑剧情片，以维多利亚时代两位魔术师的生死斗为主线。影片结构如魔术般精巧，通过日记嵌套和时空交错，层层揭开“移形换影”惊人秘密背后的代价。休·杰克曼与克里斯蒂安·贝尔的表演精准刻画了痴迷与偏执。电影充满哥特式的暗黑氛围，情感上是对艺术极致追求下人性扭曲的冷峻审视，结局震撼，余味苦涩。
85. 《低俗小说》
昆汀·塔伦蒂诺的这部黑色犯罪喜剧，以其环形叙事、密集的话痨式对白和突然的暴力美学，彻底改变了电影语言。文森特、朱尔斯、布奇等角色命运交织，在荒诞、巧合与神谕般的对话中展开。影片解构了黑帮片，情感玩世不恭又带有莫名的哲学意味。它既是对流行文化的狂欢式致敬，也是对命运无常的一次酷劲十足的展示，影响深远。
86. 《超脱》
这部剧情片以阴郁、破碎的影像风格，直击教育系统与个体精神世界的困境。阿德里安·布洛迪饰演的代课老师亨利，试图在充斥问题学生的社区学校中保持超脱，却无法避免被他人痛苦卷入。影片穿插动画表达内心撕裂，情感极度压抑、疏离又充满无处安放的同情。它是对现代社会中沟通失效、精神孤岛状态的沉重描绘，令人感到深深的无力与悲伤。
87. 《哈利·波特与密室》
系列第二部延续魔法世界的拓展，基调更为黑暗。密室的传说、蛇怪的威胁、家养小精灵多比的警告，共同编织了一个充满悬疑的校园冒险。影片深入探讨了纯血统主义的偏见与危害，汤姆·里德尔的日记揭示了伏地魔的年轻往事。情感上加强了友谊的考验与忠诚的价值，是哈利在成长路上进一步认识魔法世界复杂性与自身特殊性的关键一年。
88. 《还有明天》 (注：此片在常见豆瓣Top250列表中不常见，简介也较新。基于提供简介。)
这部意大利战后背景的剧情片，聚焦于底层女性迪莉娅在丈夫暴虐与生活重压下的艰难生存。影片刻画了1940年代意大利女性普遍的低微地位，以及她们在琐碎痛苦中寻找微小慰藉与自由时刻的韧性。一封信件成为改变命运的契机。电影表达的主要情感是压抑中的渴望、无声的抗争以及对“出逃”可能性的微弱希望，是对特定历史时期女性处境的一次平实而有力的白描。
89. 《喜剧之王》
周星驰这部带有自传色彩的喜剧剧情片，道尽了龙套演员的辛酸与坚持。“其实我是一个演员”成为跨越阶层的尊严宣言。尹天仇与柳飘飘“我养你啊”的对话，是华语电影中最朴素动人的爱情表白之一。影片在无厘头笑料下包裹着真挚的追梦赤子心与底层相濡以沫的温情。情感内核是对理想主义的悲壮坚守，笑中带泪，感人至深。
90. 《摩登时代》
查理·卓别林的这部默片喜剧经典，是对工业时代流水线异化工人的最辛辣讽刺与最富人性关怀的批判。卓别林饰演的工人被机器吞噬、拧螺丝成癖等场景，想象力惊人又直指本质。在经济大萧条的背景下，影片通过流浪汉与孤女的相守，展现了底层人民苦中作乐的顽强与善良。情感是深沉的悲悯与温暖的希望交织，是电影史上不朽的人文丰碑。
91. 《一一》
杨德昌的这部家庭史诗剧情片，以冷静、绵长的镜头审视台北一个中产家庭三代人的生活切片。从婚礼到葬礼，通过不同家庭成员（父亲、母亲、女儿、儿子）的视角，展现了人生各阶段的困惑、疏离与追寻。影片宛如一部现代都市生活的百科全书，情感深沉克制，充满了对生命本质（诞生、童年、初恋、事业、婚姻、衰老、死亡）的哲学思考，余韵悠长。
92. 《杀人回忆》
这部韩国犯罪悬疑片改编自未破的真实连环杀人案。影片摒弃了神探破案的模式，以警察们徒劳的努力、错误的线索和不断升级的无力感，营造出令人窒息的悬疑氛围。宋康昊饰演的朴探员最终凝视镜头的眼神，直击人心。电影情感是累积的愤怒、沮丧与对历史悬案无法释怀的创伤感，是对一个时代混乱与集体焦虑的深刻记录。
93. 《致命ID》
这部心理惊悚悬疑片在一个暴风雨夜的汽车旅馆内，上演了一场身份认同的杀戮游戏。十名陌生人接连死去，留下的编号线索指向惊人的心理真相。影片节奏紧凑，悬念迭起，最后的反转彻底颠覆了之前的认知。它探讨了人格分裂的复杂性与暴力根源，情感上充满了密闭空间的恐惧、彼此猜疑的紧张，以及对人性黑暗面的惊悚窥探。
94. 《春光乍泄》
王家卫的这部爱情剧情片，将镜头对准布宜诺斯艾利斯一对同性恋人黎耀辉与何宝荣的分合纠葛。影片以独特的色调、手持摄影与音乐，捕捉了爱情中的依赖、伤害、放纵与悔恨。“不如我们从头来过”成为最致命的魔咒。情感极度浓烈又弥漫着挥之不去的孤独与漂泊感，是对亲密关系本质的一次疼痛而优美的解剖，关乎爱、自由与无法回头的失去。
95. 《海豚湾》
这部纪录片以惊心动魄的“偷拍”形式，揭露了日本太地町血腥屠杀海豚的真相。影片兼具调查报道的严谨与环保行动的紧张感，用铁证冲击观众的良知。理查德·奥巴里的转变与行动是贯穿的情感主线。电影表达的情感是强烈的愤怒、对生命被残害的巨大悲痛，以及呼吁行动迫在眉睫的急切，是一部具有强大舆论冲击力的环保主义宣言。
96. 《加勒比海盗》
这部奇幻冒险喜剧开创了海盗电影的新纪元。约翰尼·德普塑造的杰克·斯派洛船长，以其妖娆的身姿、机灵的眼神和诡辩的言辞，成为影史最迷人的反英雄之一。影片将海盗传说、诅咒魔法、爱情与冒险完美融合，节奏明快，娱乐性极高。情感核心是向往自由的海盗精神、亦正亦邪的浪漫友情，以及一场酣畅淋漓、奇想天外的航海大冒险。
97. 《美国往事》
这部黑帮史诗剧情片以近四小时的篇幅，纵横数十年，讲述纽约犹太黑帮成员“面条”的往事与幻灭。影片以倒叙、梦境般的闪回，勾勒出友情、背叛、爱情与时间无情的巨大画卷。情感怀旧而苍凉，充满了对逝去青春、破碎梦想与被篡改记忆的无限感伤。它不仅是黑帮兴衰史，更是一曲关于美国梦、时间与回忆的宏大而悲伤的挽歌。
98. 《红辣椒》
今敏的这部动画科幻悬疑片，以其天马行空的想象力和令人眼花缭乱的视觉拼接，探讨了梦境入侵现实的恐怖与瑰丽。美女医师千叶敦子化身为梦境侦探“红辣椒”，在光怪陆离的梦境世界中追凶。影片将弗洛伊德心理学、赛博朋克与日本流行文化熔于一炉，情感跳跃在惊悚、狂欢与哲思之间，是对当代人精神焦虑与潜意识欲望的一次华丽而深邃的巡礼。
99. 《七宗罪》
这部黑色犯罪惊悚片营造了一个阴雨连绵、肮脏压抑的都市地狱。连环杀手依照天主教“七宗罪”教义设计谋杀，老警探萨默塞特与新警探米尔斯的追凶过程充满智性较量与心理压迫。影片氛围绝望，结局颠覆性的设计令人不寒而栗。情感核心是对人性之恶的冰冷展示、对都市罪恶的悲观审视，以及面对“世界很美好，值得为之奋斗，我同意后半句”的沉重叹息。
100. 《唐伯虎点秋香》
这部无厘头喜剧的巅峰之作，将才子佳人的传统故事彻底解构为一场笑料百出的疯狂派对。周星驰饰演的唐伯虎，以其层出不穷的搞笑发明、对联武斗和对秋香（巩俐）的荒唐追求，贡献了无数经典桥段。影片节奏密集，笑点天马行空，情感上则是典型的“有情人终成眷属”的欢乐童话。它纯粹为娱乐而生，是华语喜剧电影中经久不衰的快乐源泉。

"""

# ==========================================
# 4. 交互式运行主程序
# ==========================================

if __name__ == "__main__":
    recommender = SVDRecommender(raw_data)
    
    print("\n" + Color.PURPLE + "="*50 + Color.END)
    print(f"{Color.BOLD}🎬 语义电影推荐系统已启动 (基于 TF-IDF + SVD){Color.END}")
    print("支持语义搜索，例如：")
    print("  - \"关于父爱和牺牲的感人故事\"")
    print("  - \"压抑的犯罪惊悚片\"")
    print("  - \"轻松搞笑的喜剧\"")
    print(f"{Color.PURPLE}输入 'q' 或 'exit' 退出{Color.END}")
    print(Color.PURPLE + "="*50 + Color.END + "\n")

    while True:
        try:
            user_input = input(f"{Color.CYAN}👉 请输入你想看的电影风格/心情/关键词: {Color.END}").strip()
        except EOFError:
            break
        
        if user_input.lower() in ['q', 'exit', 'quit']:
            print(f"{Color.YELLOW}👋 再见！祝您观影愉快！{Color.END}")
            break
            
        if not user_input:
            continue

        results = recommender.recommend(user_input, top_k=5)
        
        if not results:
            print(f"{Color.RED}   ⚠️ 抱歉，模型未捕捉到相关语义，请尝试更具体的描述。{Color.END}")
        else:
            print(f"\n{Color.BOLD}为您找到 {len(results)} 部相关电影：{Color.END}")
            for i, (movie, score) in enumerate(results):
                title = movie['title']
                # 截取前60个字，去掉换行
                summary = movie['content'][:60].replace('\n', '')
                
                print(f"   {i+1}. {Color.YELLOW}《{title}》{Color.END} (匹配度: {Color.GREEN}{score:.2f}{Color.END})")
                print(f"      📝 {summary}...")
            print(Color.DARKCYAN + "-" * 40 + Color.END)